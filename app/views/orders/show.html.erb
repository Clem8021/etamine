<div class="floating-back-button">
  <%= link_to root_path, class: "back-link" do %>
    <span>‚Üê</span>
    <%= image_tag "logo.png", alt: "Logo Etamine", class: "logo-small" %>
  <% end %>
</div>

<div class="panier-container">
  <h1>Votre panier</h1>

  <% if @order.order_items.any? %>
    <div class="order-items">
      <% @order.order_items.each do |item| %>
        <div class="order-item">
          <!-- Image produit -->
          <div class="item-image">
            <%= image_tag item.product.image_url, alt: item.product.name, class: "product-thumb" %>
          </div>

          <!-- Infos produit -->
          <div class="item-info">
            <strong><%= item.product.name %></strong><br>
            <%= item.quantity %> √ó <%= number_to_currency(item.price_cents / 100.0, unit: "‚Ç¨") %>

            <% if item.color.present? %>
              <br><em>Couleur :</em> <%= item.color %>
            <% end %>

            <% if item.size.present? %>
              <% if item.product.customizable_price? %>
                <br><em>Budget choisi :</em>
                <%= number_to_currency(item.size.to_i / 100.0, unit: "‚Ç¨") %>
              <% else %>
                <br><em>Taille :</em> <%= item.size %>
              <% end %>
            <% end %>

            <% if item.addons.present? %>
              <br><em>Options :</em> <%= item.addons.join(", ") %>
            <% end %>

            <% if item.addon_type.present? %>
              <br><em><%= item.addon_type.capitalize %> :</em>
              <% if item.addon_text.present? %>
                "<%= item.addon_text %>"
              <% else %>
                ajout√©
              <% end %>
            <% end %>
          </div>

          <!-- Action supprimer -->
          <div class="item-actions">
            <%= button_to "Supprimer", order_order_item_path(@order, item),
                          method: :delete,
                          class: "btn-remove",
                          data: { turbo_confirm: "Supprimer cet article ?" } %>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Total -->
    <p class="cart-total">
      <strong>Total :</strong>
      <%= number_to_currency(@order.total_price, unit: "‚Ç¨") %>
    </p>

    <!-- Bouton redirection vers checkout -->
    <div class="checkout-actions">
      <%= link_to "Passer la commande", checkout_order_path(@order), class: "btn btn-primary" %>
    </div>
  <% else %>
    <p>Votre panier est vide üõí</p>
    <%= link_to "Retour √† la boutique", boutique_path, class: "btn btn-secondary" %>
  <% end %>
</div>
