<%= render "shared/navbar" %>

<div class="admin-order-details">
  <h1>Commande nÂ°<%= @order.id %></h1>

  <h3>ğŸ‘¤ Client</h3>
  <p><strong>Nom :</strong> <%= @order.full_name %></p>
  <p><strong>Email :</strong> <%= @order.email %></p>
  <p><strong>TÃ©lÃ©phone :</strong> <%= @order.phone_number %></p>
  <p><strong>Adresse :</strong> <%= @order.address %></p>

  <% if @order.delivery_detail %>
    <h3>ğŸšš Livraison / Retrait</h3>
    <p><strong>Mode :</strong> <%= @order.delivery_detail.mode == "delivery" ? "Livraison" : "Retrait en boutique" %></p>
    <p><strong>Date :</strong> <%= l(@order.delivery_detail.date, format: :long) %></p>
    <% if @order.delivery_detail.time_slot.present? %>
      <p><strong>CrÃ©neau :</strong> <%= @order.delivery_detail.time_slot %></p>
    <% end %>
  <% end %>

  <h3>ğŸ›’ Articles</h3>
  <ul class="order-items">
    <% @order.order_items.each do |item| %>
      <li>
        <%= image_tag item.product.image_url, class: "product-thumb" %>
        <strong><%= item.product.name %></strong> â€“
        <%= item.quantity %> Ã— <%= number_to_currency(item.price_cents / 100.0, unit: "â‚¬") %>
        <% if item.addons.present? %>
          <br><em>Options :</em> <%= item.addons.join(", ") %>
        <% end %>
      </li>
    <% end %>
  </ul>

  <h3>ğŸ’¶ RÃ©capitulatif</h3>
  <p><strong>Sous-total :</strong> <%= number_to_currency(@order.subtotal_cents / 100.0, unit: "â‚¬") %></p>
  <p><strong>Frais de livraison :</strong> <%= number_to_currency(@order.delivery_fee_cents / 100.0, unit: "â‚¬") %></p>
  <p class="total"><strong>Total Ã  payer :</strong> <%= number_to_currency(@order.total_due, unit: "â‚¬") %></p>

  <h3>âš™ï¸ Actions</h3>
  <%= form_with model: @order, url: order_path(@order), method: :patch, local: true do |f| %>
    <%= f.label :status, "Statut de la commande" %>
    <%= f.select :status, Order::STATUSES, {}, class: "form-control" %>
    <%= f.submit "Mettre Ã  jour", class: "btn btn-secondary" %>
  <% end %>

  <%= link_to "â¬… Retour aux commandes", orders_path, class: "btn btn-outline" %>
</div>
