<%= render "shared/navbar" %>

<div class="boutique">
  <h1 class="section-title">ðŸŒ¸ Notre Boutique</h1>

  <!-- Filtres catÃ©gories -->
  <div class="category-filters">
    <%= link_to "Tous",
                boutique_path,
                class: "btn #{'btn-active' if params[:category].blank?}" %>

    <% Product::CATEGORIES.each do |cat| %>
      <%= link_to Product.category_label(cat),
                  boutique_path(category: cat),
                  class: "btn #{'btn-active' if params[:category] == cat}" %>
    <% end %>
  </div>

  <% @products_by_category.each do |category, products| %>
    <h2 class="category-title"><%= Product.category_label(category) %></h2>

    <div class="products-grid">
      <% if category == "roses" %>
        <% products.group_by(&:variety).each do |variety, grouped| %>
          <% next if variety.nil? %> <!-- ðŸ”¹ On saute les produits sans variÃ©tÃ© -->
          <% product = grouped.first %>
          <div class="product-macaron">
            <%= image_tag product.image_url, alt: product.name, class: "product-image" %>
            <div class="product-info">
              <h3 class="product-name"><%= variety.to_s.capitalize %></h3>
              <p class="product-price">Ã€ partir de <%= number_to_currency(product.min_price_cents / 100.0, unit: "â‚¬") %></p>
              <%= link_to "Voir", product_path(product), class: "btn" %>
            </div>
          </div>
        <% end %>
      <% else %>
        <% products.each do |product| %>
          <div class="product-macaron">
            <%= image_tag product.image_url, alt: product.name, class: "product-image" %>
            <div class="product-info">
              <h3 class="product-name"><%= product.name %></h3>
              <p class="product-price">Ã€ partir de <%= number_to_currency(product.price_euros, unit: "â‚¬") %></p>
              <%= link_to "Voir", product_path(product), class: "btn" %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  <% end %>
</div>

<!-- EncadrÃ© info -->
<div class="floral-info-box">
  <div class="icon">ðŸŒ·</div>
  <p>
    Les photos sont <strong>non contractuelles</strong> : les fleurs peuvent varier selon les saisons.
    <br>
    Pour toute autre demande, nâ€™hÃ©sitez pas Ã  nous <strong>contacter par tÃ©lÃ©phone ou Ã  passer en boutique</strong>.
  </p>
</div>
</section>
